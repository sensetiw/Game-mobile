# Telegram-–±–æ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ (Telegraf + SQLite)

–ì–æ—Ç–æ–≤—ã–π –∫ –¥–µ–ø–ª–æ—é –±–æ—Ç —Å –º–æ–¥—É–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π:
- üë• –°–≤—è–∑–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ø–æ –≤–∑–∞–∏–º–Ω–æ–º—É —Å–æ–≥–ª–∞—Å–∏—é, one-to-one)
- üõí –ü–æ–∫—É–ø–∫–∏-–∑–∞–∫–∞–∑ (—Å–ø–∏—Å–æ–∫ –æ—Ç —Å–æ–∑–¥–∞—Ç–µ–ª—è –∫ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é)
- üìã –ó–∞–¥–∞–Ω–∏—è (–¥–µ–¥–ª–∞–π–Ω—ã + –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è)
- üéÆ –ú–∏–Ω–∏-–∏–≥—Ä–∞ Alias (3 —Å–ª–æ–∂–Ω–æ—Å—Ç–∏)
- ü™ô –£—Ç–∏–ª–∏—Ç–∞ ¬´–ú–æ–Ω–µ—Ç–∫–∞¬ª

## –°—Ç–µ–∫
- Node.js
- Telegraf
- SQLite (`better-sqlite3`)
- PM2 (–¥–ª—è VPS)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
.
‚îú‚îÄ index.js
‚îú‚îÄ src
‚îÇ  ‚îú‚îÄ bot.js
‚îÇ  ‚îú‚îÄ config.js
‚îÇ  ‚îú‚îÄ db/index.js
‚îÇ  ‚îú‚îÄ keyboards/reply.js
‚îÇ  ‚îú‚îÄ modules
‚îÇ  ‚îÇ  ‚îú‚îÄ connections.js
‚îÇ  ‚îÇ  ‚îú‚îÄ shopping.js
‚îÇ  ‚îÇ  ‚îú‚îÄ tasks.js
‚îÇ  ‚îÇ  ‚îú‚îÄ coin.js
‚îÇ  ‚îÇ  ‚îî‚îÄ games/alias.js
‚îÇ  ‚îî‚îÄ data/alias
‚îÇ     ‚îú‚îÄ easy.json
‚îÇ     ‚îú‚îÄ medium.json
‚îÇ     ‚îî‚îÄ hard.json
‚îî‚îÄ data/
   ‚îî‚îÄ bot.db (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:
- `BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞.

–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ:
- `DB_PATH` ‚Äî –ø—É—Ç—å –∫ sqlite-—Ñ–∞–π–ª—É (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `./data/bot.db`).

> –°–µ–∫—Ä–µ—Ç—ã –Ω–µ —Ö—Ä–∞–Ω–∏–º –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏. –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` –∏ —Ç–æ–∫–µ–Ω—ã.

## –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

```bash
npm install
export BOT_TOKEN=123456:ABCDEF
npm start
```

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞:
```bash
npm run check
```

## VPS (Ubuntu) + PM2

### –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫

```bash
git clone <repo_url>
cd Game-mobile
npm install
export BOT_TOKEN=123456:ABCDEF
pm2 start npm --name game-mobile-bot -- start
pm2 save
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

```bash
cd /opt/tg-bot
git pull
npm install
pm2 restart game-mobile-bot && pm2 logs game-mobile-bot
```

## –ß—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ë–î

–¢–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:
- `users`
- `invites`
- `links`
- `user_states`
- `shopping_lists`
- `shopping_items`
- `tasks`
- `alias_sessions`

## –ö—Ä–∞—Ç–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### 1) –°–≤—è–∑–∏
1. A: `üë• –°–≤—è–∑–∏ ‚Üí –°–æ–∑–¥–∞—Ç—å –∏–Ω–≤–∞–π—Ç`.
2. –ë–æ—Ç –≤—ã–¥–∞—ë—Ç –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π –∫–æ–¥ (TTL 10 –º–∏–Ω).
3. B: `üë• –°–≤—è–∑–∏ ‚Üí –í–≤–µ—Å—Ç–∏ –∫–æ–¥`.
4. A –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–ø—Ä–æ—Å: `‚úÖ –ü—Ä–∏–Ω—è—Ç—å / ‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å`.
5. –ü–æ—Å–ª–µ –ø—Ä–∏–Ω—è—Ç–∏—è —Å–≤—è–∑—å –∞–∫—Ç–∏–≤–Ω–∞.

### 2) –ü–æ–∫—É–ø–∫–∏-–∑–∞–∫–∞–∑
1. –°–æ–∑–¥–∞—Ç–µ–ª—å: `üõí –ü–æ–∫—É–ø–∫–∏ ‚Üí –°–æ–∑–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫`.
2. –í–≤–æ–¥–∏—Ç —Ç–æ–≤–∞—Ä—ã —Å—Ç—Ä–æ–∫–∞–º–∏.
3. –ü—Ä–µ–≤—å—é: `‚úÖ –û—Ç–ø—Ä–∞–≤–∏—Ç—å / ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å / ‚ùå –û—Ç–º–µ–Ω–∞`.
4. –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ø–∏—Å–æ–∫.
5. –û—Ç–º–µ—á–∞–µ—Ç —Ç–æ–≤–∞—Ä—ã inline-–∫–Ω–æ–ø–∫–∞–º–∏ (`‚úÖ`/`‚Ü©`).
6. –°–æ–∑–¥–∞—Ç–µ–ª—é –ø—Ä–∏—Ö–æ–¥—è—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏.
7. –ö–æ–≥–¥–∞ –≤—Å—ë –∫—É–ø–ª–µ–Ω–æ ‚Äî —Å–ø–∏—Å–æ–∫ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

### 3) –ó–∞–¥–∞–Ω–∏—è
1. –°–æ–∑–¥–∞—Ç–µ–ª—å: `üìã –ó–∞–¥–∞–Ω–∏—è ‚Üí ‚ûï –°–æ–∑–¥–∞—Ç—å`.
2. –í–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç, –≤—ã–±–∏—Ä–∞–µ—Ç –¥–µ–¥–ª–∞–π–Ω (`–°–µ–≥–æ–¥–Ω—è` / `–ó–∞–≤—Ç—Ä–∞` / `–ë–µ–∑ –¥–µ–¥–ª–∞–π–Ω–∞`).
3. –î–ª—è `–°–µ–≥–æ–¥–Ω—è/–ó–∞–≤—Ç—Ä–∞` –≤–≤–æ–¥–∏—Ç—Å—è –≤—Ä–µ–º—è `HH:MM`.
4. –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–ø—Ä–æ—Å: `‚úÖ –ü—Ä–∏–Ω—è—Ç—å / ‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å`.
5. –ü–æ—Å–ª–µ –ø—Ä–∏–Ω—è—Ç–∏—è: `‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ / ‚è∞ –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ / ‚ùå –û—Ç–∫–∞–∑–∞—Ç—å—Å—è`.
6. –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è: –∑–∞ 1 —á–∞—Å, –≤ –¥–µ–¥–ª–∞–π–Ω –∏ –∑–∞—Ç–µ–º –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤ –¥–æ 3 –ø–æ–≤—Ç–æ—Ä–æ–≤.

### 4) –ú–æ–Ω–µ—Ç–∫–∞
1. `ü™ô –ú–æ–Ω–µ—Ç–∫–∞`.
2. –ö–Ω–æ–ø–∫–∏: `–ö–∏–Ω—É—Ç—å –º–æ–Ω–µ—Ç–∫—É`, `–°–µ—Ä–∏—è –∏–∑ 3`, `–°–µ—Ä–∏—è –∏–∑ 5`.
3. –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ —Å–≤—è–∑–∏ –ø–∞—Ä—ã.

### 5) Alias
1. `üéÆ –ò–≥—Ä—ã ‚Üí Alias`.
2. –í—ã–±–æ—Ä —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: –ª—ë–≥–∫–∏–π/—Å—Ä–µ–¥–Ω–∏–π/—Å–ª–æ–∂–Ω—ã–π.
3. –ö–Ω–æ–ø–∫–∏ —Ä–∞—É–Ω–¥–∞: `‚úÖ –£–≥–∞–¥–∞–ª–∏`, `‚è≠ –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å`, `üõë –°—Ç–æ–ø`.
4. –ü—Ä–∞–≤–∏–ª–æ –æ—á–∫–æ–≤: —É–≥–∞–¥–∞–ª–∏ `+1`, –ø—Ä–æ–ø—É—Å–∫ `0`.

## –õ–æ–≥–∏
–í `console.log` –ø–∏—à—É—Ç—Å—è –∫–ª—é—á–µ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è:
- —Å—Ç–∞—Ä—Ç –±–æ—Ç–∞
- —Å–æ–∑–¥–∞–Ω–∏–µ/–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ/—Ä–∞–∑—Ä—ã–≤ —Å–≤—è–∑–∏
- —Å–æ–∑–¥–∞–Ω–∏–µ/–ø—Ä–∏–Ω—è—Ç–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞
- —Å—Ç–∞—Ä—Ç/—Å—Ç–æ–ø Alias
